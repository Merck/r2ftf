<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to r2rtf • r2rtf</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to r2rtf">
<meta property="og:description" content="Start here if this is your first time using r2rtf.  You'll learn the basic philosophy, the most important rtf table generation verbs. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r2rtf</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Initial Version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-file-code"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../articles/r2rtf.html">
    <span class="fas fa-play-circle"></span>
     
    Get Start
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fas fa-book"></span>
     
    Articles
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper"></span>
     
    Changelog
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Merck/r2rtf/">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="r2rtf_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to r2rtf</h1>
            
      
      
      <div class="hidden name"><code>r2rtf.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p><code>r2rtf</code> is an R package to create production ready tables and figures in RTF format. The R package is designed to</p>
<ul>
<li>provide simple “verb” functions that correspond to each component of a table, to help you translate data frame to table in RTF file.</li>
<li>enables pipes (<code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code>).</li>
<li>only focus on <strong>table format</strong>. Data manipulation and analysis shall be handled by other R packages. (e.g. <code>tidyverse</code>)</li>
<li>
<code>r2rtf</code> minimizes package dependency</li>
</ul>
<p>Before creating an RTF table we need to:</p>
<ul>
<li><p>Figure out table layout.</p></li>
<li><p>Split the layout into small tasks in the form of a computer program.</p></li>
<li><p>Execute the program.</p></li>
</ul>
<p>This document introduces <code>r2rtf</code> basic set of tools, and show how to transfer data frames into Table, Listing, and Figure (TLFs).</p>
<p>Other extended examples and features are covered in different document listed in <a href="https://merck.github.io/r2rtf/articles/index.html">table of content</a>.</p>
</div>
<div id="data-adverse-events" class="section level2">
<h2 class="hasAnchor">
<a href="#data-adverse-events" class="anchor"></a>Data: Adverse Events</h2>
<p>To explore the basic RTF generation verbs in <code>r2rtf</code>, we’ll use the dataset <code>r2rtf_adae</code>. This dataset contain adverse events (AE) information from a clinical trial.</p>
<p>Below is the meaning of relevant variables. More information can be found in help page of the dataset (<code><a href="../reference/r2rtf_adae.html">?r2rtf_adae</a></code>)</p>
<ul>
<li>USUBJID: Unique Subject Identifier</li>
<li>TRTA: Actual Treatment</li>
<li>AEDECOD: Dictionary-Derived Term</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r2rtf_adae</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">TRTA</span>, <span class="va">AEDECOD</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>
<span class="co">##       USUBJID    TRTA                   AEDECOD</span>
<span class="co">## 1 01-701-1015 Placebo APPLICATION SITE ERYTHEMA</span>
<span class="co">## 2 01-701-1015 Placebo APPLICATION SITE PRURITUS</span>
<span class="co">## 3 01-701-1015 Placebo                 DIARRHOEA</span>
<span class="co">## 4 01-701-1023 Placebo                  ERYTHEMA</span></code></pre></div>
</div>
<div id="table-ready-data" class="section level2">
<h2 class="hasAnchor">
<a href="#table-ready-data" class="anchor"></a>Table ready data</h2>
<p><code>dplyr</code> and <code>tidyr</code> packages are used for data manipulation to create a data frame that contains all the information we want to add in an RTF table.</p>
<blockquote>
<p>Please note other packages can also be used for the same purpose.</p>
</blockquote>
<p>In this AE example, we provide number of subjects with each type of AE by treatment group.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="va">r2rtf_adae</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">TRTA</span>, <span class="va">AEDECOD</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">TRTA</span>, values_from <span class="op">=</span> <span class="va">n</span>, values_fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">tbl</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>
<span class="co">## # A tibble: 4 x 4</span>
<span class="co">##   AEDECOD        Placebo `Xanomeline High Dose` `Xanomeline Low Dose`</span>
<span class="co">##   &lt;chr&gt;            &lt;int&gt;                  &lt;int&gt;                 &lt;int&gt;</span>
<span class="co">## 1 ABDOMINAL PAIN       1                      2                     3</span>
<span class="co">## 2 AGITATION            2                      1                     2</span>
<span class="co">## 3 ALOPECIA             1                      0                     0</span>
<span class="co">## 4 ANXIETY              2                      0                     4</span></code></pre></div>
</div>
<div id="single-table-verbs" class="section level2">
<h2 class="hasAnchor">
<a href="#single-table-verbs" class="anchor"></a>Single table verbs</h2>
<p><code>r2rtf</code> aims to provide one function for each type of table layout. Commonly used verbs includes:</p>
<ul>
<li>
<code>rtf_page</code>: RTF page information</li>
<li>
<code>rtf_title</code>: RTF title information</li>
<li>
<code>rtf_colheader</code>: RTF column header information</li>
<li>
<code>rtf_body</code>: RTF table body information</li>
<li>
<code>rtf_footnote</code>: RTF footnote information</li>
<li>
<code>rtf_source</code>: RTF data source information</li>
</ul>
<p>All these verbs is designed to enables usage of pipes (<code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code>). A full list of all functions can be found in <a href="https://merck.github.io/r2rtf/reference/index.html">package reference</a></p>
</div>
<div id="simple-example" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-example" class="anchor"></a>Simple Example</h2>
<p>A minimal example below illustrates how to combine verbs using pipes to create an RTF table.</p>
<ul>
<li>
<code>rtf_body</code> is used to define table body layout.</li>
<li>
<code>rtf_encode</code> transfers table layout information into RTF syntax.</li>
<li>
<code>write_rtf</code> save RTF encoding into a file with file extension <code>.rtf</code>
</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>                     <span class="co"># Step 1 Add table  attributes </span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>                   <span class="co"># Step 2 Convert attributes to RTF encode </span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae1.rtf"</span><span class="op">)</span>     <span class="co"># Step 3 Write to a .rtf file</span></code></pre></div>
<embed src="pdf/intro-ae1.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="column-width" class="section level2">
<h2 class="hasAnchor">
<a href="#column-width" class="anchor"></a>Column Width</h2>
<p>If we want to adjust the width of each column to provide more space to the first column, and this can be achieved by updating <code>col_rel_width</code> in <code>rtf_body</code>.</p>
<p>The input of <code>col_rel_width</code> is a vector with same length for number of columns. This argument defines the relative length of each column within a pre-defined total column width.</p>
<p>In this example, the defined relative width is 3:2:2:2. Only the ratio of <code>col_rel_width</code> is used. Therefore it is equivalent to use <code>col_rel_width = c(6,4,4,4)</code> or <code>col_rel_width = c(1.5,1,1,1)</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># define relative width</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>                             
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae2.rtf"</span><span class="op">)</span>               </code></pre></div>
<embed src="pdf/intro-ae2.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed><p>Note:</p>
<ul>
<li>The <code>col_rel_width</code> in <code>rtf_body</code> function only control relative width of table body. Therefore the column header is not aligned as expected. More details will be provided in next example to take care of column header width.</li>
<li>The total column width is defined in <code>col_width</code> argument of <code>rtf_page</code> function.</li>
</ul>
</div>
<div id="column-headers" class="section level2">
<h2 class="hasAnchor">
<a href="#column-headers" class="anchor"></a>Column Headers</h2>
<p>In previous example, we found issue of misaligned column header. We can fix the issue by using <code>rtf_colheader</code> function.</p>
<p>In <code>rtf_colheader</code>, <code>colheader</code> argument is used to provide content of column header. We used <code>"|"</code> to separate the columns.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae3.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae3.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed><p>We also allow column headers be displayed in multiple lines. If an empty column name is needed for a column, you can insert a space between two vertical lines; e.g., <code>"name 1 | | name 3"</code>.</p>
<p>The <code>col_rel_width</code> can be used to align column header with different number of columns.</p>
<p>By using <code>rtf_colheader</code> with <code>col_rel_width</code>, one can customize complicated column headers. If there are multiple pages, column header will repeat at each page by default.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span>, <span class="fl">50</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">" | Treatment"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae4.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae4.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="text-alignment" class="section level2">
<h2 class="hasAnchor">
<a href="#text-alignment" class="anchor"></a>Text Alignment</h2>
<p>In <code>rtf_*</code> functions such as <code>rtf_body</code>, <code>rtf_footnote</code>, <code>text_justification</code> argument is used to align text. Default is <code>"c"</code> for center justification. To vary text justification by column, use character vector with length of vector equal to number of columns displayed (e.g., <code><a href="https://rdrr.io/r/base/c.html">c("c","l","r")</a></code>).</p>
<p>All possible inputs can be found in the first column of <code>r2rtf:::justification()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">r2rtf</span><span class="fu">:::</span><span class="fu"><a href="../reference/justification.html">justification</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">##   type      name rtf_code_text rtf_code_row</span>
<span class="co">## 1    l      left          \\ql       \\trql</span>
<span class="co">## 2    c    center          \\qc       \\trqc</span>
<span class="co">## 3    r     right          \\qr       \\trqr</span>
<span class="co">## 4    d   decimal          \\qj             </span>
<span class="co">## 5    j justified          \\qj</span></code></pre></div>
<p>Below is an example to make first column left aligned and center aligned for the rest.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>text_justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae5.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae5.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="text-style" class="section level2">
<h2 class="hasAnchor">
<a href="#text-style" class="anchor"></a>Text Style</h2>
<p>In <code>rtf_*</code> functions such as <code>rtf_body</code>, <code>rtf_footnote</code>, etc., <code>text_format</code> argument is used for controlling text style. Default is NULL for normal.</p>
<p>All possible inputs and corresponding text style can be found in <code>r2rtf:::font_format()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">r2rtf</span><span class="fu">:::</span><span class="fu"><a href="../reference/font_format.html">font_format</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">##   type        name rtf_code</span>
<span class="co">## 1           normal         </span>
<span class="co">## 2    b        bold      \\b</span>
<span class="co">## 3    i     italics      \\i</span>
<span class="co">## 4    u   underline     \\ul</span>
<span class="co">## 5    s      strike \\strike</span>
<span class="co">## 6    ^ superscript  \\super</span>
<span class="co">## 7    _   subscript    \\sub</span></code></pre></div>
<p>Combination of format type are permitted as input (e.g., <code>"ub"</code> for bold and underlined text). To vary text format by column, use character vector with length of vector equal to number of columns displayed (e.g., <code><a href="https://rdrr.io/r/base/c.html">c("i", "u", "ib")</a></code>).</p>
<p>Below is an example to make first column in bold and normal for the rest.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>text_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae6.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae6.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="table-border" class="section level2">
<h2 class="hasAnchor">
<a href="#table-border" class="anchor"></a>Table Border</h2>
<p>In <code>rtf_*</code> functions such as <code>rtf_body</code>, <code>rtf_footnote</code>, etc., <code>border_left</code>, <code>border_right</code>, <code>border_top</code>, and <code>border_bottom</code> control border.</p>
<p>In example of <code>intro-ae4.rtf</code>, if we want to remove the top border of <code>"Adverse Events"</code> in header, we can change default value <code>"single"</code> to <code>""</code> in <code>border_top</code> argument as showed below.</p>
<p>All possible border type inputs can be found in <code>r2rtf:::border_type()</code>. There are 26 different border type, we only display first six here.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">r2rtf</span><span class="fu">:::</span><span class="fu"><a href="../reference/border_type.html">border_type</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">##         name     rtf_code</span>
<span class="co">## 1                        </span>
<span class="co">## 2     single      \\brdrs</span>
<span class="co">## 3     double     \\brdrdb</span>
<span class="co">## 4        dot    \\brdrdot</span>
<span class="co">## 5       dash   \\brdrdash</span>
<span class="co">## 6 small dash \\brdrdashsm</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">" | Treatment"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    border_top <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"single"</span>, <span class="st">"single"</span>, <span class="st">"single"</span><span class="op">)</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae7.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae7.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="title" class="section level2">
<h2 class="hasAnchor">
<a href="#title" class="anchor"></a>Title</h2>
<p>The title(s) can be added using the <code>rtf_title</code> function as showed in below example. To get guidance on how to change title text style, aligning title, and other features in the <code>rtf_title</code> function, help page <code>?r2rtf::rtf_title()</code> is a good resource.</p>
<p>We can provide a vector for the <code>title</code> argument. Each value is a separate line. The format can also be controlled by providing a vector input in <code>text_format</code>.</p>
<blockquote>
<p>We used soft return to break lines in title.</p>
</blockquote>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>
    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adverse Event Count by Treatment Group"</span>,
              <span class="st">"(An example)"</span><span class="op">)</span>,
    text_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">""</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae8.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae8.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="footnote" class="section level2">
<h2 class="hasAnchor">
<a href="#footnote" class="anchor"></a>Footnote</h2>
<p>The footnote(s) can be added using <code>footnote</code> argument in the <code>rtf_footnote</code> function as showed in below example.</p>
<p>We can provide a vector for the <code>footnote</code> argument. Each value is a separate line.</p>
<p>Below example showed the case when using <code>as_table = TRUE</code> (default) to display footnote inside the table body.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span><span class="op">(</span>
    footnote <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Adverse events are coded according to MedDRA version 23.0"</span>,
      <span class="st">"adam-adae"</span>
    <span class="op">)</span>,
    as_table <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae9.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae9.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed><p>Below example showed the case when using <code>as_table = FALSE</code> to display footnote outside the table body.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span><span class="op">(</span>
    footnote <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Adverse events are coded according to MedDRA version 23.0"</span>,
      <span class="st">"adam-adae"</span>
    <span class="op">)</span>,
    as_table <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae10.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae10.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="data-source" class="section level2">
<h2 class="hasAnchor">
<a href="#data-source" class="anchor"></a>Data Source</h2>
<p>Data source can be added using <code>source</code> argument in the <code>rtf_source</code> function as showed in below example.</p>
<p>Below example showed the case when using <code>as_table = FALSE</code> (default) to display data source outside the table body.</p>
<blockquote>
<p>We can also adjust data source to be left aligned. By default the alignment matches the table border.</p>
</blockquote>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rtf_page.html">rtf_page</a></span><span class="op">(</span>col_width <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span>                                      <span class="co"># set total column width </span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="st">"[datasource: adam-adae]"</span>,
    text_justification <span class="op">=</span> <span class="st">"l"</span>,
    as_table <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae11.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae11.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed><p>Below example showed the case when using <code>as_table = TRUE</code> to display data source inside the table body.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span><span class="op">(</span>
    source <span class="op">=</span> <span class="st">"[datasource: adam-adae]"</span>,
    as_table <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae12.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae12.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="special-character" class="section level2">
<h2 class="hasAnchor">
<a href="#special-character" class="anchor"></a>Special Character</h2>
<p>In the <code>r2rtf</code> package, <code>'^'</code> is a character to be converted to rtf code <code>'\\super'</code> to generate superscript; <code>'_'</code> is for subscript.</p>
<p>Similarly, <code>'&lt;='</code> is a <code>r2rtf</code> package specified character to be converted to LaTeX command <code>'\\leq'</code> to generate special character <span class="math inline">\(\leq\)</span>.</p>
<p>LaTeX commands can be used for Greek letters and math symbol such as <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\pm\)</span>, <span class="math inline">\(\infty\)</span>. You will need to use double backslash <code>\\</code> to escape backslash in R. i.e. <code>"\\alpha"</code>, <code>"\\pm"</code> and <code>"\\infty"</code>. A list of LaTex commands can be found <a href="https://www.overleaf.com/learn/latex/List_of_Greek_letters_and_math_symbols">here</a></p>
<p>Example below demonstrate the idea.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group{^a}"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events{\\super 1} | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span><span class="op">(</span>
    footnote <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"{\\super 1}Adverse events are coded according to MedDRA 20.0{&lt;=}version {\\leq}23.0"</span>,
      <span class="st">"\\alpha + \\gamma &lt;= \\infty"</span>,
      <span class="st">"{^a}adam-adae"</span>
    <span class="op">)</span>,
    as_table <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae13.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae13.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="table-color" class="section level2">
<h2 class="hasAnchor">
<a href="#table-color" class="anchor"></a>Table Color</h2>
<p>Each cell’s text and background color are controllable. Take <code>intro-ae13.rtf</code> as an example, if we want to add gray background color to cells with 0 AE, we need to create a color name matrix corresponding to each cell in table body.</p>
<p>Then assign this background color matrix to <code>text_background_color</code> argument in <code>rtf_body</code> function as showed below.</p>
<p>Note:</p>
<ul>
<li>When creating a color name matrix, each element needs to be a color name defined in <code><a href="https://rdrr.io/r/grDevices/colors.html">grDevices::colours()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span>
<span class="va">color_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/trimws.html">trimws</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">tbl1</span>, <span class="fl">2</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="st">"0"</span>, <span class="st">"gray"</span>, <span class="st">"white"</span><span class="op">)</span>
<span class="va">color_matrix</span>
<span class="co">##      AEDECOD Placebo Xanomeline High Dose Xanomeline Low Dose</span>
<span class="co">## [1,] "white" "white" "white"              "white"            </span>
<span class="co">## [2,] "white" "white" "white"              "white"            </span>
<span class="co">## [3,] "white" "white" "gray"               "gray"             </span>
<span class="co">## [4,] "white" "white" "gray"               "white"            </span>
<span class="co">## [5,] "white" "white" "white"              "white"            </span>
<span class="co">## [6,] "white" "white" "white"              "white"</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Event Count by Treatment Group"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
    text_background_color <span class="op">=</span> <span class="va">color_matrix</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae14.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae14.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="page-setup" class="section level2">
<h2 class="hasAnchor">
<a href="#page-setup" class="anchor"></a>Page setup</h2>
<p>The total number of rows in each page can be controlled in <code>nrow</code> argument of <code>rtf_page</code> function. Every lines is counted including title, subline, header, body, footnote, source, and extra rows.</p>
<p>The value in <code>nrow</code> is the maximum of row allowed in one page, the actual rows display can be slightly smaller.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="op">]</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_page.html">rtf_page</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adverse Events Example"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>
    colheader <span class="op">=</span> <span class="st">"Adverse Events | Placebo | Xanomeline High Dose | Xanomeline Low Dose"</span>,
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>
    col_rel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,
    text_justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae15.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae15.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="subline_by-feature" class="section level2">
<h2 class="hasAnchor">
<a href="#subline_by-feature" class="anchor"></a>subline_by feature</h2>
<p>Users can use <code>subline_by</code> argument in the <code>rtf_body</code> function to group table by assigned <code>subline_by</code> variable.</p>
<p>A subject line will be displayed at the beginning of each page based on the variable provided to <code>subline_by</code>. Different value of <code>subline_by</code> will be break into different pages.</p>
<p>Below example showed using treatment group as <code>subline_by</code> variable.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aegt5</span>  <span class="op">&lt;-</span> <span class="va">r2rtf_adae</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">TRTA</span>, <span class="va">AEDECOD</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Count</span> <span class="op">&gt;</span> <span class="fl">7</span><span class="op">)</span> <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">TRTA</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">Count</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">aegt5</span><span class="op">)</span>
<span class="co">## # A tibble: 6 x 3</span>
<span class="co">##   TRTA                 AEDECOD                   Count</span>
<span class="co">##   &lt;chr&gt;                &lt;chr&gt;                     &lt;int&gt;</span>
<span class="co">## 1 Placebo              DIARRHOEA                     9</span>
<span class="co">## 2 Placebo              ERYTHEMA                      9</span>
<span class="co">## 3 Placebo              PRURITUS                      8</span>
<span class="co">## 4 Xanomeline High Dose PRURITUS                     26</span>
<span class="co">## 5 Xanomeline High Dose APPLICATION SITE PRURITUS    22</span>
<span class="co">## 6 Xanomeline High Dose APPLICATION SITE ERYTHEMA    15</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aegt5</span>  <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"Top Adverse Events by Treatment Group"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>colheader <span class="op">=</span> <span class="st">"Adverse Events|Count"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>subline_by <span class="op">=</span> <span class="st">"TRTA"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae16.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae16.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="page_by-feature" class="section level2">
<h2 class="hasAnchor">
<a href="#page_by-feature" class="anchor"></a>page_by feature</h2>
<p>Users can use <code>page_by</code> argument in the <code>rtf_body</code> function to group/separate table by single cell row with assigned <code>page_by</code> variable’s value in it.</p>
<p>A row header will be generated at the begining of each <code>page_by</code> group.</p>
<p>if <code>new_page=TRUE</code>, different value of <code>group_by</code> will be break into different pages. Default is <code>FALSE</code>.</p>
<p>Below example showed using treatment group as <code>page_by</code> variable.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aegt5</span>  <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"Top Adverse Events by Treatment Group"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>colheader <span class="op">=</span> <span class="st">"Adverse Events|Count"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>page_by <span class="op">=</span> <span class="st">'TRTA'</span>,
           new_page <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae17.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae17.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="group_by-feature" class="section level2">
<h2 class="hasAnchor">
<a href="#group_by-feature" class="anchor"></a>group_by feature</h2>
<p>Users can use <code>group_by</code> argument in the <code>rtf_body</code> function to display once for group variable.</p>
<p>Below example showed using treatment group as <code>group_by</code> variable.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aegt5</span>  <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"Top Adverse Events by Treatment Group"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_colheader.html">rtf_colheader</a></span><span class="op">(</span>colheader <span class="op">=</span> <span class="st">"Treatment|Adverse Events|Count"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/rtf_body.html">rtf_body</a></span><span class="op">(</span>group_by <span class="op">=</span> <span class="st">'TRTA'</span>,
           text_justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'l'</span>,<span class="st">'l'</span>,<span class="st">'c'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae18.rtf"</span><span class="op">)</span></code></pre></div>
<embed src="pdf/intro-ae18.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
<div id="figure" class="section level2">
<h2 class="hasAnchor">
<a href="#figure" class="anchor"></a>Figure</h2>
<p>The last example showed how to insert a figure into a RTF document.</p>
<p>The workflow can be summarized as:</p>
<ul>
<li>save figures into PNG format. (e.g. using <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggplot2::ggsave()</a></code>).</li>
<li>read PNG files into R as binary file using <code>rtf_read_png</code>.</li>
<li>add optional features using <code>rtf_title</code>, <code>rtf_footnote</code>, <code>rtf_source</code>.</li>
<li>set up page and figure options using <code>rtf_figure</code>.</li>
<li>convert to rtf encoding using <code><a href="../reference/rtf_encode.html">rtf_encode(doc_type = "figure")</a></code>. (Note: it is important to set <code>doc_type = "figure")</code> as the default is <code>doc_type = "table</code> to set up tables).</li>
<li>write rtf to a file using <code>write_rtf</code>.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pruritus</span> <span class="op">&lt;-</span> <span class="va">r2rtf_adae</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">AEDECOD</span> <span class="op">==</span> <span class="st">"PRURITUS"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">TRTA</span>, <span class="va">AEDECOD</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span><span class="op">)</span> 

<span class="va">fig</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">pruritus</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">TRTA</span>, y <span class="op">=</span> <span class="va">Count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span>

<span class="va">fig</span>       </code></pre></div>
<p><img src="r2rtf_files/figure-html/unnamed-chunk-44-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filename</span> <span class="op">&lt;-</span> <span class="st">"fig/intro-fig1.png"</span>
<span class="fu">ggsave</span><span class="op">(</span><span class="va">filename</span>, <span class="va">fig</span><span class="op">)</span>
<span class="co">## Saving 7.29 x 4.51 in image</span>

<span class="va">filename</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_read_png.html">rtf_read_png</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_title.html">rtf_title</a></span><span class="op">(</span><span class="st">"Pruritus Frequency by Treatment Group"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_footnote.html">rtf_footnote</a></span><span class="op">(</span><span class="st">"footnote here"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_source.html">rtf_source</a></span><span class="op">(</span><span class="st">"[datasource: adam-adae]"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_figure.html">rtf_figure</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/rtf_encode.html">rtf_encode</a></span><span class="op">(</span>doc_type <span class="op">=</span> <span class="st">"figure"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/write_rtf.html">write_rtf</a></span><span class="op">(</span><span class="st">"rtf/intro-ae19.rtf"</span><span class="op">)</span>    </code></pre></div>
<embed src="pdf/intro-ae19.pdf" width="100%" height="400px" style="display: block; margin: auto;" type="application/pdf"></embed>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Yilong Zhang, Siruo Wang, Simiao Ye, Madhusudhan Ginnaram. Site built with pkgdown 1.6.1.
  </p>
  <p>Copyright © 2021 Merck Sharp &amp; Dohme Corp., a subsidiary of Merck &amp; Co., Inc., Kenilworth, NJ, USA.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

---
title: "r2rtf 中文简介"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '2'
description: >
  Start here if this is your first time using r2rtf.
  You'll learn the basic philosophy, the most important rtf table generation verbs.
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, collapse = TRUE)
# library(r2rtf)
devtools::load_all()
library(dplyr)
```

## Overview

`r2rtf` is an R package to create production ready tables and figures in RTF format.
The R package is designed to

- provide simple "verb" functions that correspond to each component of a table,
  to help you translate data frame to table in RTF file.
- enable pipes (`%>%`).
- only focus on **table format**.
  Data manipulation and analysis should be handled by other R packages. (e.g., `tidyverse`)
- `r2rtf` minimizes package dependency

Before creating an RTF table we need to:

- Figure out table layout.
- Split the layout into small tasks in the form of a computer program.
- Execute the program.

This document introduces `r2rtf` basic set of tools, and show how to transfer
data frames into Table, Listing, and Figure (TLFs).

Other extended examples and features are covered in different document listed in
[vignettes](https://merck.github.io/r2rtf/articles/index.html).

## 中文支持

`r2rtf` 支持中文表格。如果表格中有中文字符，
需要使用`r2rtf::utf8Tortf()`将中文字符转换为对应的RTF代码。

这里我们举一个简单的例子来给出中文标题和脚注

```{r}
head(iris) %>% 
  rtf_title(utf8Tortf("中文标题: abc")) %>% 
  rtf_body() %>% 
  rtf_footnote(utf8Tortf("中文脚注: abc")) %>%
  rtf_encode() %>% 
  write_rtf("chinese-1.rtf")
```

当数据中有中文字符时， 我们可以用类似的方法输出。


```{r}
tbl <- data.frame(id = c("一", "二"), 
                  group = c("实验组", "对照组"), 
                  results = c("Positive", "Negative"))
```

这里要注意`utf8Tortf`仅允许长度为一的字符串。
可以通过`purrr::map_chr`进行向量化处理。 

```{r}
tbl %>% 
  mutate(across(.fns = function(x) purrr::map_chr(x, utf8Tortf) )) %>%
  rtf_title(utf8Tortf("中文标题: abc")) %>%
  rtf_body() %>% 
  rtf_footnote(utf8Tortf("中文脚注: abc")) %>%
  rtf_encode() %>% 
  write_rtf("chinese-2.rtf")
```

## TODO

增加 `r2rtf.Rmd` 当中内容的翻译。

